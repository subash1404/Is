1.	Step 1
1.	Change the declaration for HOME_NET to your actual home network IP address range,
2.	For a typical home network, the expression will be 192.168.0.1/24 or 192.168.1.1/24 (if you’re not sure whether your third number is a 0 or 1, check your gateway/router documentation or just ping it. If you want to cover all IP addresses beginning with 192.168, then use the expression 192.168.0.0/16
3.	In a typical large office network using network address translation, the expression will be 10.0.0.0/8
2.	Change the var RULE_PATH declaration to match the actual location of your rules files. Typically the rules will be stored in Z:\Snort\rules.
3.	Similarly, change the PREPROC_RULE_PATH to match the appropriate directory location on your system, such as Z:\Snort\preproc_rules.
4.	Comment out (put a # character in the first position in the line) the SO_RULE_PATH declaration, as the Windows implementation of Snort doesn’t use shared object rules.
var RULE_PATH Z:\Snort\rules #var SO_RULE_PATH ../so_rules
var PREPROC_RULE_PATH Z:\Snort\preproc_rules

 


2.	Step 2
 
# If you are using reputation preprocessor set these var WHITE_LIST_PATH Z:\Snort\rules
var BLACK_LIST_PATH Z:\Snort\rules
 
1.	For most users, there are no changes needed to the decoder configurations.
2.	At the end of this section, there is a configuration setting to indicate the default directory where Snort logs should be written. Uncomment this line by deleting the # character in the first position and edit the line to include the Z:\Snort\log default directory path.
config logdir:Z:\Snort\log
3.	Step 3
1.	For most users, there are no changes needed to the base detection engine settings, so move on to step 4. These settings are used for performance tuning and reflect memory and processing capabilities.
4.	Step 4
1.	Change the dynamic loaded library path references to reflect their location in Windows, and in the case of the dynamic engine to replace the default Linux filename with the Windows equivalent. Snort references these locations and loads the libraries at start-up.


 
 

1.	dynamicpreprocessor directory Z:\Snort\lib\snort_dynamicpreprocessor
2.	dynamicengine Z:\Snort\lib\snort_dynamicengine\sf_engine.dll
3.	Comment out (put a # in the first position in the line) the
dynamicdetection directory declaration.
2.	One point to be aware of when configuration is done and you move one to running Snort: loading the dynamic libraries requires Snort to write to the Windows registry, an action typically requiring administrator privileges. For this reason the command shell should be launched with the “Run as administrator” option from the Windows start menu when preparing to start Snort.
5.	Step 5
1.	Comment out (put # in the first position on the line) all the rows in the Inline packet normalization preprocessor. This preprocessor is only used when Snort is implemented in in-line IPS mode, and Snort should ignore it otherwise, but on Windows it will cause an error if left uncommented.
Comment following lines:
#preprocessor normalize_ip4
#preprocessor normalize_tcp: ips ecn stream #preprocessor normalize_icmp4 #preprocessor normalize_ip6
#preprocessor normalize_icmp6
Comment whitelist $WHITE_LIST_PATH/white_list.rules and blacklist
$BLACK_LIST_PATH/black_list.rules lines. Also ensure that you add change the line above $WHITE_LIST_PATH
Change nested_ip inner , \ to nested_ip inner #, \

6.	Step 6
1.	To add log file to store alerts generated by snort, search for "output log" test and add following line:
output alert_fast: snort-alerts.ids
Leave the metadata reference lines at the end of step 6 uncommented: include classification.config and include reference.config .
2.		Add complete path for "include classification.config" and "include reference.config" files.
include Z:\snort\etc\classification.config include Z:\snort\etc\reference.config
 
7.	Step 7
 

1.	Remove the comment on the line to allow ICMP rules, if it is alredy commented.
include $RULE_PATH/icmp.rules
2.	Similary, remove the comment of ICMP-info rules comment, if it is already commented.
include $RULE_PATH/icmp-info.rules
 
8.	Go to the "Z:\Snort\log" directory and create a file: snort-alerts.ids.




 
 

9.	Goto Z:\Snort\Rules folder open local rules file and type all the IDS rules and save the file.

EXECUTION STEPS:
To start snort in IDS mode, run following command:
snort –c Z:\Snort\etc\snort.conf –A console –i 1 RULES:
A. alert icmp 192.168.18.193 any -> 192.168.18.136 any (msg: "ICMP Testing Rule"; sid:1000001; rev:001; )
B. alert tcp 192.168.18.193 any -> any any (msg: "Traffic "; sid:1000002; rev:001; )
C.	alert tcp 192.168.18.193 any -> any any (msg:"Possible exploit"; content:"SVCE"; sid:1000003; rev:001;)
D.	alert tcp 192.168.18.193 any -> $HOME_NET 21 (msg:”FTP connection attempt”; sid:1000007; rev:1;)
E.	alert tcp 192.168.18.193 any -> $EXTERNAL_NET $HTTP_PORTS (msg:"test eBay rule";flow:to_server,established; content:"www.gmail.com"; nocase; sid:10000002;rev:1;)
1. alert icmp 192.168.22.189 any -> 192.168.22.196 any (msg: "ICMP Testing Rule"; sid:1000001; rev:001; )
2. alert ip 192.168.22.189 any -> 192.168.22.196 any (msg: "IP Testing Rule"; sid:1000002; rev:002; )
3.	alert icmp any any -> any any (msg: "Ping with TTl=100"; sid:1000003; rev:003; )
4.	alert icmp any any -> any any (msg: "foo"; content:"foo"; sid:1000005; rev:005; )
5.	pass icmp any any -> any 80 (msg: "Ping with TTl=100"; sid:1000004; rev:004; )
6.	alert icmp any any -> 192.168.18.12 any	(msg: "Ping with TTl=100"; ttl:100; sid:1000004; rev:004; )
7.	alert tcp any any -> 192.168.18.6 any (flags:A; ack:0; msg: "TCP PING DETECTED"; sid:1000004; rev:004; )